dependencies:
  pre:
    - curl -o $HOME/$GAE_SDK_NAME $GAE_SDK_LINK
    - unzip -q -d $HOME $HOME/$GAE_SDK_NAME

test:
  override:
    - phpunit --bootstrap qa-tests/autoload.php qa-tests

deployment:
  production:
    branch: master
    commands:
      - sudo apt-get install sshpass
      - sshpass -p $PROD_PASSWORD ssh ${PROD_USERNAME}@${PROD_HOSTNAME} -p $PROD_SSH_PORT 'apt-get install git'
      - sshpass -p $PROD_PASSWORD ssh ${PROD_USERNAME}@${PROD_HOSTNAME} -p $PROD_SSH_PORT 'git clone $LAPPRES_GIT_LINK'
  devserver:
    branch: develop
    commands:
      - $HOME/$GAE_PUSH_SCRIPT -A $LAPPRES_DEV_NAME update . --oauth2_refresh_token=$APPENGINE_TOKEN

